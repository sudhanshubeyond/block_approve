define(["jquery","core/ajax","core/templates","core/notification",],function(e,a,t,i){return{reviews:function(){e(document).on("click",".page-link",function(t){t.preventDefault();var l=e(this).attr("href"),n=r("page",l);e(".activity-search").val();var o=e("#batchsearch_id").find(":selected").val(),s=e("#coursesearch_id").find(":selected").val(),c=e("#assigntype_id").find(":selected").val(),d=e(".down-arrow").attr("val");if("Batch"===o&&(o=""),"Course"===s&&(s=""),"Classification"===c&&(c=""),!n)return!1;var p={pix:M.util.image_url("i/loading","core"),component:"moodle"},m=e('<img style="display: block;margin: 100px auto" />').attr("src",M.util.image_url(p.pix,p.component)).addClass("spinner");e(".sorted_data").html('<tr> <td colspan="8">'+m.get(0).outerHTML+"</td></tr>"),a.call([{methodname:"block_vlearn_reviews_get_reviews",args:{program:o,cid:s,type:c,page:n,duesorting:d}},])[0].done(function(a){e(".sorted_data").html(a.displayhtml),e(".pagination-nav-filter").html(a.pagedata)}).fail(i.exception)}),e(document).on("keyup",".activity-search",l(function(t){t.preventDefault();var l=window.location.href,n=e(".activity-search").val();r("page",l);var o={pix:M.util.image_url("i/loading","core"),component:"moodle"},s=e("<img />").attr("src",M.util.image_url(o.pix,o.component)).addClass("spinner");e(".allreviews-display").html('<div class="text-center">'+s.get(0).outerHTML+"</div>"),a.call([{methodname:"block_vlearn_reviews_get_reviews",args:{activityname:n,page:0}},])[0].done(function(a){e(".allreviews-display").html(a.displayhtml)}).fail(i.exception)},1e3)),e(document).on("change",".batchsearch, .coursesearch, .assigntype",l(function(t){t.preventDefault();var l=window.location.href;e(".activity-search").val();var n=e("#batchsearch_id").find(":selected").val(),o=e("#coursesearch_id").find(":selected").val(),s=e("#assigntype_id").find(":selected").val();"Batch"===n&&(n=""),"Course"===o&&(o=""),"Classification"===s&&(s=""),r("page",l);var c={pix:M.util.image_url("i/loading","core"),component:"moodle"},d=e("<img />").attr("src",M.util.image_url(c.pix,c.component)).addClass("spinner");e(".allreviews-display").html('<div class="text-center">'+d.get(0).outerHTML+"</div>"),a.call([{methodname:"block_vlearn_reviews_get_reviews",args:{program:n,cid:o,type:s,page:0,duesorting:""}},])[0].done(function(a){e(".allreviews-display").html(a.displayhtml),""!==n&&e(".coursesearch").html(a.options)}).fail(i.exception)},1e3)),e(document).on("click",".down-arrow",l(function(t){t.preventDefault();var l=window.location.href,n=e("#batchsearch_id").find(":selected").val(),o=e("#coursesearch_id").find(":selected").val(),s=e("#assigntype_id").find(":selected").val(),c=e(this).attr("val");"asc"===c?(c="desc",e(".down-arrow").addClass("custom-up"),e(this).attr("val","desc")):"desc"===c&&(c="asc",e(".down-arrow").removeClass("custom-up"),e(this).attr("val","asc")),"Batch"===n&&(n=""),"Course"===o&&(o=""),"Classification"===s&&(s=""),r("page",l);var d={pix:M.util.image_url("i/loading","core"),component:"moodle"},p=e('<img style="display: block;margin: 100px auto" />').attr("src",M.util.image_url(d.pix,d.component)).addClass("spinner");e(".sorted_data").html('<tr> <td colspan="8">'+p.get(0).outerHTML+"</td></tr>"),a.call([{methodname:"block_vlearn_reviews_get_reviews",args:{program:n,cid:o,type:s,page:0,duesorting:c}},])[0].done(function(a){e(".sorted_data").html(a.displayhtml),e(".pagination-nav-filter").html(a.pagedata)}).fail(i.exception)},1e3)),e(document).on("click","#grade_popup",l(function(t){var i=e(this).attr("data-programid"),r=e(this).attr("data-id"),l=e(this).attr("cmid");a.call([{methodname:"block_vlearn_reviews_get_pending_submissions",args:{programid:i,instanceid:r,cmid:l}},])[0].done(function(a){e(".custom-modal").html(a.displayhtml),e("#exampleModal").modal("show")})},1e3))}};function r(e,a){return decodeURIComponent((RegExp("[?|&]"+e+"=([^&;]+?)(&|#|;|$)").exec(a)||[null,""])[1].replace(/\+/g,"%20"))||null}function l(e,a){var t=0;return function(){var i=this,r=arguments;clearTimeout(t),t=setTimeout(function(){e.apply(i,r)},a||0)}}});